# -*- coding: utf-8 -*-
"""Analytics Evaluation Question 2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Nl3MrpXkp8NvjA2L2Bi67EV4rN1o3qsg

A team of plantation planners are concerned about the yield of oil palm trees, which seems to 
fluctuate. They have collected a set of data and needed help in analysing on how external 
factors influence fresh fruit bunch (FFB) yield. Some experts are of opinion that the flowering of 
oil palm tree determines the FFB yield, and are linked to the external factors. Perform the 
analysis, which requires some study on the background of oil palm tree physiology.
"""

import pandas as pd
import numpy as np

data=pd.read_csv('/content/palm_ffb.csv')
data

data.dropna()

data.describe()

corData=data.corr().round(3)
corData

import seaborn as sn
import matplotlib.pyplot as plt

sn.heatmap(corData, annot=True)
plt.show()

"""From the heatmap we can see that SoilMoisture , Average_Temp and Max_Temp are correlated\"""

from sklearn.linear_model import LinearRegression
from sklearn import preprocessing

X=np.array(data[['SoilMoisture','Average_Temp','Min_Temp','Max_Temp','Precipitation','Working_days','HA_Harvested']])
Y=np.array(data[['FFB_Yield']])

LR_Model=LinearRegression()
LR_Model.fit(X,Y)
importance=LR_Model.coef_[0]
for i,v in enumerate(importance):
	print('Feature: %0d, Score: %.5f' % (i,v))
plt.bar([x for x in range(len(importance))], importance)
plt.show()

"""We can see from the linear regression coefficient that average_temp , Min_Temp, and Working days affect the FFB_Yield in regression model"""

from sklearn.tree import DecisionTreeRegressor
# define the model
model = DecisionTreeRegressor()
# fit the model
model.fit(X, Y)
# get importance
importance = model.feature_importances_
for i,v in enumerate(importance):
	print('Feature: %0d, Score: %.5f' % (i,v))
# plot feature importance
plt.bar([x for x in range(len(importance))], importance)
plt.show()

"""We can see from the Decision Tree regressor importance feature that the highest importance attribute/ feature is HA_Harvested followed By , Precipitation and Average_Temp. It means they are affeting teh FFB_Yield"""

from sklearn.ensemble import RandomForestRegressor
model = RandomForestRegressor()
# fit the model
model.fit(X, Y)
# get importance
importance = model.feature_importances_
for i,v in enumerate(importance):
	print('Feature: %0d, Score: %.5f' % (i,v))
# plot feature importance
plt.bar([x for x in range(len(importance))], importance)
plt.show()

"""We can see from the Random Forest Regressor importance feature that the highest importance attribute/ feature is HA_Harvested followed By , Precipitation and Average_Temp. It means they are affeting teh FFB_Yield

So, we can conclude that HA_Harverst, Precipitation, Average_Temp are very influence fresh fruit bunch (FFB) yield. Beside the feature / attribute that affect the FFB_Yield directly, we can see in heatmap above that Average_Temp has a correlation with SoilMoisture and Max_Temp. so we can say SoilMoisture and Max_Temp indirectly influence FFB_Yield
"""